07/30/2025 18:34:38 - INFO - __main__ - ***** Running training *****
07/30/2025 18:34:38 - INFO - __main__ -   Num examples = 30
07/30/2025 18:34:38 - INFO - __main__ -   Num batches each epoch = 30
07/30/2025 18:34:38 - INFO - __main__ -   Num Epochs = 20
07/30/2025 18:34:38 - INFO - __main__ -   Instantaneous batch size per device = 1
07/30/2025 18:34:38 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 1
07/30/2025 18:34:38 - INFO - __main__ -   Gradient Accumulation steps = 1
07/30/2025 18:34:38 - INFO - __main__ -   Total optimization steps = 600
Steps:   0%|          | 0/600 [00:00<?, ?it/s]Traceback (most recent call last):
  File "/root/context-engineering-intro/EasyControl/train/train.py", line 1069, in <module>
    main(args)
  File "/root/context-engineering-intro/EasyControl/train/train.py", line 925, in main
    model_pred = transformer(
  File "/root/miniconda3/envs/easycontrol/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/easycontrol/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/envs/easycontrol/lib/python3.10/site-packages/accelerate/utils/operations.py", line 818, in forward
    return model_forward(*args, **kwargs)
  File "/root/miniconda3/envs/easycontrol/lib/python3.10/site-packages/accelerate/utils/operations.py", line 806, in __call__
    return convert_to_fp32(self.model_forward(*args, **kwargs))
  File "/root/miniconda3/envs/easycontrol/lib/python3.10/site-packages/torch/amp/autocast_mode.py", line 44, in decorate_autocast
    return func(*args, **kwargs)
  File "/root/context-engineering-intro/EasyControl/train/src/transformer_flux.py", line 494, in forward
    encoder_hidden_states, hidden_states = torch.utils.checkpoint.checkpoint(
  File "/root/miniconda3/envs/easycontrol/lib/python3.10/site-packages/torch/_compile.py", line 51, in inner
    return disable_fn(*args, **kwargs)
  File "/root/miniconda3/envs/easycontrol/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 838, in _fn
    return fn(*args, **kwargs)
  File "/root/miniconda3/envs/easycontrol/lib/python3.10/site-packages/torch/utils/checkpoint.py", line 495, in checkpoint
    ret = function(*args, **kwargs)
TypeError: FluxTransformer2DModel.forward.<locals>.create_custom_forward.<locals>.custom_forward() got an unexpected keyword argument 'cond_temb'
Traceback (most recent call last):
  File "/root/context-engineering-intro/EasyControl/train/train.py", line 1069, in <module>
    main(args)
  File "/root/context-engineering-intro/EasyControl/train/train.py", line 925, in main
    model_pred = transformer(
  File "/root/miniconda3/envs/easycontrol/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/root/miniconda3/envs/easycontrol/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/miniconda3/envs/easycontrol/lib/python3.10/site-packages/accelerate/utils/operations.py", line 818, in forward
    return model_forward(*args, **kwargs)
  File "/root/miniconda3/envs/easycontrol/lib/python3.10/site-packages/accelerate/utils/operations.py", line 806, in __call__
    return convert_to_fp32(self.model_forward(*args, **kwargs))
  File "/root/miniconda3/envs/easycontrol/lib/python3.10/site-packages/torch/amp/autocast_mode.py", line 44, in decorate_autocast
    return func(*args, **kwargs)
  File "/root/context-engineering-intro/EasyControl/train/src/transformer_flux.py", line 494, in forward
    encoder_hidden_states, hidden_states = torch.utils.checkpoint.checkpoint(
  File "/root/miniconda3/envs/easycontrol/lib/python3.10/site-packages/torch/_compile.py", line 51, in inner
    return disable_fn(*args, **kwargs)
  File "/root/miniconda3/envs/easycontrol/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 838, in _fn
    return fn(*args, **kwargs)
  File "/root/miniconda3/envs/easycontrol/lib/python3.10/site-packages/torch/utils/checkpoint.py", line 495, in checkpoint
    ret = function(*args, **kwargs)
TypeError: FluxTransformer2DModel.forward.<locals>.create_custom_forward.<locals>.custom_forward() got an unexpected keyword argument 'cond_temb'
